--Use DB and schema
USE DATABASE LA_DB;
--01c06220-0107-05c8-0015-ace300053086
USE SCHEMA LA_SCHEMA;


--Merge First name and last name

SELECT * FROM customer;

SELECT CUSTOMER_ID, CONCAT(FIRST_NAME, ' ', LAST_NAME) AS FULLNAME, EMAIL, PHONE, JOIN_DATE
FROM CUSTOMER;

--01c06224-0107-05c8-0015-ace30005315a

--Trim '+' sign from phone number
SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, LTRIM(PHONE,'+') AS CLEAN_PHONE, JOIN_DATE
FROM CUSTOMER;

-- 01c06226-0107-05c8-0015-ace30005319e

-- Use of I/LIKE function

--LIKE - CASE SENSITIVE
SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, JOIN_DATE
FROM CUSTOMER
WHERE FIRST_NAME LIKE '%JOHN%';

-- 01c06229-0107-059f-0015-ace3000541be

--ILIKE - NOT CASE SENSITIVE
SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, JOIN_DATE
FROM CUSTOMER
WHERE FIRST_NAME ILIKE '%JOHN%';

-- 01c0622b-0107-05c8-0015-ace30005323a

-- USE OF LEN() FUNCTION
SELECT CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE, LEN(ADDRESS) AS ADDRESS_LENGTH, JOIN_DATE
FROM CUSTOMER;

-- 01c0622d-0107-059f-0015-ace300054216

--USE OF LAST_QUERY_ID
SELECT CUSTOMER_ID FROM TABLE(RESULT_SCAN(LAST_QUERY_ID())); 
-- Here query id is blank which means last query id. Blank and -1 are same which returns previous query id.
-- RESULT_SCAN will return the result

-- 01c0622f-0107-05c8-0015-ace300053286

-- How LAST_QUERY_ID works?
SELECT LAST_QUERY_ID(1); --return the first query id in this session which is 01c06220-0107-05c8-0015-ace300053086

SELECT LAST_QUERY_ID(-1); --returns previous query id -- 01c06231-0107-05c8-0015-ace3000532be 
-- current query id: 01c06234-0107-063a-0015-ace30005601a

SELECT LAST_QUERY_ID(-2); -- RETURNS PREVIOUS TO PREVIOUS QUERY ID: 01c06231-0107-05c8-0015-ace3000532be
--current query id for SELECT LAST_QUERY_ID(-2): 01c06237-0107-063a-0015-ace30005603e


